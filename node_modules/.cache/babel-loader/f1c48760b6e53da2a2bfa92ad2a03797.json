{"ast":null,"code":"import _Array$from from \"@babel/runtime-corejs2/core-js/array/from\";\nimport _Toast from \"antd-mobile/lib/toast\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport { Copy } from 'components';\nimport Router from 'next/router';\nimport React from 'react';\nimport styles from \"./UserPrivilegeItem.less\";\nexport var PrivilegeTypes;\n\n(function (PrivilegeTypes) {\n  PrivilegeTypes[PrivilegeTypes[\"Exchangeable\"] = 1] = \"Exchangeable\";\n  PrivilegeTypes[PrivilegeTypes[\"Exchanged\"] = 2] = \"Exchanged\";\n  PrivilegeTypes[PrivilegeTypes[\"Invalid\"] = 3] = \"Invalid\";\n  PrivilegeTypes[PrivilegeTypes[\"Unable\"] = 4] = \"Unable\";\n  PrivilegeTypes[PrivilegeTypes[\"Delay\"] = 5] = \"Delay\";\n})(PrivilegeTypes || (PrivilegeTypes = {}));\n\nvar convertTime = function convertTime(time) {\n  return time.substring(0, 10).replace(/-/g, '.');\n};\n\nvar goProductList =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee() {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return Router.push('/product/category');\n\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function goProductList() {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar StatusButton = function StatusButton(type) {\n  switch (type) {\n    case PrivilegeTypes.Exchangeable:\n      return React.createElement(\"span\", {\n        className: styles.button\n      }, \"\\u83B7\\u53D6\\u5238\\u7801\");\n\n    case PrivilegeTypes.Exchanged:\n      return React.createElement(\"span\", {\n        className: styles.disabledButton\n      }, \"\\u5DF2\\u83B7\\u53D6\");\n\n    case PrivilegeTypes.Invalid:\n      return React.createElement(\"span\", {\n        className: styles.disabledButton\n      }, \"\\u5DF2\\u5931\\u6548\");\n\n    default:\n      return React.createElement(\"span\", {\n        className: styles.disabledButton\n      }, \"\\u6682\\u65E0\\u6CD5\\u9886\\u53D6\");\n  }\n};\n\nvar StatusBottom = function StatusBottom(item, onClickCopy) {\n  if (item.get('type') === PrivilegeTypes.Delay || item.get('type') === PrivilegeTypes.Unable) {\n    return React.createElement(\"section\", {\n      className: styles.plainWrapper\n    }, React.createElement(\"span\", null, \"\\u7B7E\\u6536\\u5546\\u54C17\\u5929\\u540E\\u65B9\\u53EF\\u9886\\u53D6\\u4F7F\\u7528\"));\n  }\n\n  if (item.get('type') === PrivilegeTypes.Invalid) {\n    return React.createElement(\"section\", {\n      className: styles.plainWrapper,\n      onClick: goProductList\n    }, React.createElement(\"span\", null, \"\\u60A8\\u6682\\u65F6\\u65E0\\u6CD5\\u4EAB\\u53D7\\u6B64\\u6743\\u76CA\\uFF0C\\u518D\\u6B21\\u4E0B\\u5355\\u5373\\u53EF\\u6FC0\\u6D3B\\u54E6\\uFF01\"), React.createElement(\"span\", {\n      className: styles.btn\n    }, \"\\u53BB\\u4E0B\\u5355\"));\n  }\n\n  if (item.get('redeem_code') && item.get('type') === PrivilegeTypes.Exchanged) {\n    return React.createElement(Copy, {\n      text: item.get('redeem_code'),\n      onCopied: onClickCopy\n    }, React.createElement(\"section\", {\n      className: styles.exchangeWrapper\n    }, React.createElement(\"span\", {\n      className: styles.codeText\n    }, \"\\u5151\\u6362\\u7801 \", item.get('redeem_code')), React.createElement(\"span\", {\n      className: styles.copyText\n    }, \"\\u590D\\u5236\\u5E76\\u4F7F\\u7528\")));\n  }\n\n  return React.createElement(\"section\", {\n    className: styles.plainWrapper\n  }, React.createElement(\"span\", null, \"\\u9886\\u53D6\\u6709\\u6548\\u671F\\uFF1A\", convertTime(item.get('started_at')), \" - \", convertTime(item.get('expired_at'))));\n};\n\nvar UserPrivilegeItem =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(UserPrivilegeItem, _React$Component);\n\n  function UserPrivilegeItem() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, UserPrivilegeItem);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(UserPrivilegeItem)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      clicked: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"exchange\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var _this$props, item, onExchange, error;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!_this.state.clicked) {\n                _context2.next = 2;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 2:\n              _this$props = _this.props, item = _this$props.item, onExchange = _this$props.onExchange;\n\n              if (!(item.get('type') === PrivilegeTypes.Exchangeable)) {\n                _context2.next = 8;\n                break;\n              }\n\n              _context2.next = 6;\n              return onExchange(item.get('user_priv_id'));\n\n            case 6:\n              error = _context2.sent;\n              if (error) _Toast.info(error, 3);\n\n            case 8:\n              _this.setState({\n                clicked: false\n              });\n\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    })));\n\n    return _this;\n  }\n\n  _createClass(UserPrivilegeItem, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          item = _this$props2.item,\n          onClickCopy = _this$props2.onClickCopy;\n      return React.createElement(\"div\", {\n        className: styles.item\n      }, React.createElement(\"section\", {\n        className: styles.topWrapper,\n        onClick: this.exchange\n      }, React.createElement(\"h3\", null, item.get('title')), React.createElement(\"div\", {\n        className: styles.wrapper\n      }, React.createElement(\"p\", {\n        className: styles.description\n      }, item.get('desc')), StatusButton(item.get('type')))), React.createElement(\"section\", {\n        className: styles.tape\n      }, _Array$from({\n        length: 20\n      }, function (_, i) {\n        return i;\n      }).map(function (v) {\n        return React.createElement(\"div\", {\n          className: styles.tapeDot,\n          key: v\n        });\n      })), StatusBottom(item, onClickCopy));\n    }\n  }]);\n\n  return UserPrivilegeItem;\n}(React.Component);\n\nexport default UserPrivilegeItem;","map":{"version":3,"sources":["/Users/viser/mobile-next/src/containers/Account/Privilege/UserPrivilegeItem.tsx"],"names":["Copy","Router","React","styles","PrivilegeTypes","convertTime","time","substring","replace","goProductList","push","StatusButton","type","Exchangeable","button","Exchanged","disabledButton","Invalid","StatusBottom","item","onClickCopy","get","Delay","Unable","plainWrapper","btn","exchangeWrapper","codeText","copyText","UserPrivilegeItem","clicked","state","props","onExchange","error","info","setState","topWrapper","exchange","wrapper","description","tape","length","_","i","map","v","tapeDot","Component"],"mappings":";;;;;;;;;;;AACA,SAASA,IAAT,QAAqB,YAArB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAOC,MAAP;AAEA,WAAYC,cAAZ;;WAAYA,c;AAAAA,EAAAA,c,CAAAA,c;AAAAA,EAAAA,c,CAAAA,c;AAAAA,EAAAA,c,CAAAA,c;AAAAA,EAAAA,c,CAAAA,c;AAAAA,EAAAA,c,CAAAA,c;GAAAA,c,KAAAA,c;;AAQZ,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,IAAD;AAAA,SAAkBA,IAAI,CAACC,SAAL,CAAe,CAAf,EAAkB,EAAlB,EAAsBC,OAAtB,CAA8B,IAA9B,EAAoC,GAApC,CAAlB;AAAA,CAApB;;AAEA,IAAMC,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA,2BAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACdR,MAAM,CAACS,IAAP,CAAY,mBAAZ,CADc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAbD,aAAa;AAAA;AAAA;AAAA,GAAnB;;AAIA,IAAME,YAAY,GAAG,SAAfA,YAAe,CAACC,IAAD,EAAkB;AACrC,UAAQA,IAAR;AACE,SAAKR,cAAc,CAACS,YAApB;AACE,aAAO;AAAM,QAAA,SAAS,EAAEV,MAAM,CAACW;AAAxB,oCAAP;;AACF,SAAKV,cAAc,CAACW,SAApB;AACE,aAAO;AAAM,QAAA,SAAS,EAAEZ,MAAM,CAACa;AAAxB,8BAAP;;AACF,SAAKZ,cAAc,CAACa,OAApB;AACE,aAAO;AAAM,QAAA,SAAS,EAAEd,MAAM,CAACa;AAAxB,8BAAP;;AACF;AACE,aAAO;AAAM,QAAA,SAAS,EAAEb,MAAM,CAACa;AAAxB,0CAAP;AARJ;AAUD,CAXD;;AAaA,IAAME,YAAY,GAAG,SAAfA,YAAe,CAACC,IAAD,EAAYC,WAAZ,EAAoD;AACvE,MAAID,IAAI,CAACE,GAAL,CAAS,MAAT,MAAqBjB,cAAc,CAACkB,KAApC,IAA6CH,IAAI,CAACE,GAAL,CAAS,MAAT,MAAqBjB,cAAc,CAACmB,MAArF,EAA6F;AAC3F,WACE;AAAS,MAAA,SAAS,EAAEpB,MAAM,CAACqB;AAA3B,OACE,8GADF,CADF;AAKD;;AACD,MAAIL,IAAI,CAACE,GAAL,CAAS,MAAT,MAAqBjB,cAAc,CAACa,OAAxC,EAAiD;AAC/C,WACE;AAAS,MAAA,SAAS,EAAEd,MAAM,CAACqB,YAA3B;AAAyC,MAAA,OAAO,EAAEf;AAAlD,OACE,mKADF,EAEE;AAAM,MAAA,SAAS,EAAEN,MAAM,CAACsB;AAAxB,4BAFF,CADF;AAMD;;AACD,MAAIN,IAAI,CAACE,GAAL,CAAS,aAAT,KAA2BF,IAAI,CAACE,GAAL,CAAS,MAAT,MAAqBjB,cAAc,CAACW,SAAnE,EAA8E;AAC5E,WACE,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAEI,IAAI,CAACE,GAAL,CAAS,aAAT,CAAZ;AAAqC,MAAA,QAAQ,EAAED;AAA/C,OACE;AAAS,MAAA,SAAS,EAAEjB,MAAM,CAACuB;AAA3B,OACE;AAAM,MAAA,SAAS,EAAEvB,MAAM,CAACwB;AAAxB,8BAAuCR,IAAI,CAACE,GAAL,CAAS,aAAT,CAAvC,CADF,EAEE;AAAM,MAAA,SAAS,EAAElB,MAAM,CAACyB;AAAxB,wCAFF,CADF,CADF;AAQD;;AACD,SACE;AAAS,IAAA,SAAS,EAAEzB,MAAM,CAACqB;AAA3B,KACE,0EACSnB,WAAW,CAACc,IAAI,CAACE,GAAL,CAAS,YAAT,CAAD,CADpB,SACiDhB,WAAW,CAACc,IAAI,CAACE,GAAL,CAAS,YAAT,CAAD,CAD5D,CADF,CADF;AAOD,CAjCD;;IAyCMQ,iB;;;;;;;;;;;;;;;;;;4DACa;AACfC,MAAAA,OAAO,EAAE;AADM,K;;;;;;6BAIN;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,mBACL,MAAKC,KAAL,CAAWD,OADN;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA,4BAEoB,MAAKE,KAFzB,EAEDb,IAFC,eAEDA,IAFC,EAEKc,UAFL,eAEKA,UAFL;;AAAA,oBAGLd,IAAI,CAACE,GAAL,CAAS,MAAT,MAAqBjB,cAAc,CAACS,YAH/B;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAIaoB,UAAU,CAACd,IAAI,CAACE,GAAL,CAAS,cAAT,CAAD,CAJvB;;AAAA;AAIDa,cAAAA,KAJC;AAKP,kBAAIA,KAAJ,EAAW,OAAMC,IAAN,CAAWD,KAAX,EAAkB,CAAlB;;AALJ;AAOT,oBAAKE,QAAL,CAAc;AACZN,gBAAAA,OAAO,EAAE;AADG,eAAd;;AAPS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;;;;;;6BAYF;AAAA,yBACuB,KAAKE,KAD5B;AAAA,UACCb,IADD,gBACCA,IADD;AAAA,UACOC,WADP,gBACOA,WADP;AAEP,aACE;AAAK,QAAA,SAAS,EAAEjB,MAAM,CAACgB;AAAvB,SACE;AAAS,QAAA,SAAS,EAAEhB,MAAM,CAACkC,UAA3B;AAAuC,QAAA,OAAO,EAAE,KAAKC;AAArD,SACE,gCAAKnB,IAAI,CAACE,GAAL,CAAS,OAAT,CAAL,CADF,EAEE;AAAK,QAAA,SAAS,EAAElB,MAAM,CAACoC;AAAvB,SACE;AAAG,QAAA,SAAS,EAAEpC,MAAM,CAACqC;AAArB,SAAmCrB,IAAI,CAACE,GAAL,CAAS,MAAT,CAAnC,CADF,EAEGV,YAAY,CAACQ,IAAI,CAACE,GAAL,CAAS,MAAT,CAAD,CAFf,CAFF,CADF,EAQE;AAAS,QAAA,SAAS,EAAElB,MAAM,CAACsC;AAA3B,SACG,YAAW;AAAEC,QAAAA,MAAM,EAAE;AAAV,OAAX,EAA2B,UAACC,CAAD,EAAIC,CAAJ;AAAA,eAAUA,CAAV;AAAA,OAA3B,EAAwCC,GAAxC,CAA4C,UAAAC,CAAC;AAAA,eAAI;AAAK,UAAA,SAAS,EAAE3C,MAAM,CAAC4C,OAAvB;AAAgC,UAAA,GAAG,EAAED;AAArC,UAAJ;AAAA,OAA7C,CADH,CARF,EAWG5B,YAAY,CAACC,IAAD,EAAOC,WAAP,CAXf,CADF;AAeD;;;;EAlC6BlB,KAAK,CAAC8C,S;;AAqCtC,eAAenB,iBAAf","sourcesContent":["import { Toast } from 'antd-mobile'\nimport { Copy } from 'components'\nimport Router from 'next/router'\nimport React from 'react'\nimport { Dispatch } from 'redux'\nimport styles from './UserPrivilegeItem.less'\n\nexport enum PrivilegeTypes {\n  Exchangeable = 1,\n  Exchanged,\n  Invalid,\n  Unable,\n  Delay, // 签收商品7天后方可领取使用\n}\n\nconst convertTime = (time: string) => time.substring(0, 10).replace(/-/g, '.')\n\nconst goProductList = async () => {\n  await Router.push('/product/category')\n}\n\nconst StatusButton = (type: number) => {\n  switch (type) {\n    case PrivilegeTypes.Exchangeable:\n      return <span className={styles.button}>获取券码</span>\n    case PrivilegeTypes.Exchanged:\n      return <span className={styles.disabledButton}>已获取</span>\n    case PrivilegeTypes.Invalid:\n      return <span className={styles.disabledButton}>已失效</span>\n    default:\n      return <span className={styles.disabledButton}>暂无法领取</span>\n  }\n}\n\nconst StatusBottom = (item: any, onClickCopy: (text: string) => void) => {\n  if (item.get('type') === PrivilegeTypes.Delay || item.get('type') === PrivilegeTypes.Unable) {\n    return (\n      <section className={styles.plainWrapper}>\n        <span>签收商品7天后方可领取使用</span>\n      </section>\n    )\n  }\n  if (item.get('type') === PrivilegeTypes.Invalid) {\n    return (\n      <section className={styles.plainWrapper} onClick={goProductList}>\n        <span>您暂时无法享受此权益，再次下单即可激活哦！</span>\n        <span className={styles.btn}>去下单</span>\n      </section>\n    )\n  }\n  if (item.get('redeem_code') && item.get('type') === PrivilegeTypes.Exchanged) {\n    return (\n      <Copy text={item.get('redeem_code')} onCopied={onClickCopy}>\n        <section className={styles.exchangeWrapper}>\n          <span className={styles.codeText}>兑换码 {item.get('redeem_code')}</span>\n          <span className={styles.copyText}>复制并使用</span>\n        </section>\n      </Copy>\n    )\n  }\n  return (\n    <section className={styles.plainWrapper}>\n      <span>\n        领取有效期：{convertTime(item.get('started_at'))} - {convertTime(item.get('expired_at'))}\n      </span>\n    </section>\n  )\n}\n\ninterface UserPrivilegeItemProps {\n  item: any\n  onExchange: Dispatch\n  onClickCopy: (text: string) => void\n}\n\nclass UserPrivilegeItem extends React.Component<UserPrivilegeItemProps> {\n  readonly state = {\n    clicked: false,\n  }\n\n  exchange = async () => {\n    if (this.state.clicked) return\n    const { item, onExchange } = this.props\n    if (item.get('type') === PrivilegeTypes.Exchangeable) {\n      const error = await onExchange(item.get('user_priv_id'))\n      if (error) Toast.info(error, 3)\n    }\n    this.setState({\n      clicked: false,\n    })\n  }\n\n  render() {\n    const { item, onClickCopy } = this.props\n    return (\n      <div className={styles.item}>\n        <section className={styles.topWrapper} onClick={this.exchange}>\n          <h3>{item.get('title')}</h3>\n          <div className={styles.wrapper}>\n            <p className={styles.description}>{item.get('desc')}</p>\n            {StatusButton(item.get('type'))}\n          </div>\n        </section>\n        <section className={styles.tape}>\n          {Array.from({ length: 20 }, (_, i) => i).map(v => <div className={styles.tapeDot} key={v} />)}\n        </section>\n        {StatusBottom(item, onClickCopy)}\n      </div>\n    )\n  }\n}\n\nexport default UserPrivilegeItem\n"]},"metadata":{},"sourceType":"module"}