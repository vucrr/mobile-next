{"ast":null,"code":"import _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport { takePhoto as alipayTakePhoto } from \"./alipayJSBridge\";\nimport { zipBase64 } from \"./tools\";\nexport function isIOS() {\n  if (window && window.navigator && window.navigator.userAgent) {\n    var ua = window.navigator.userAgent;\n    return /enjoyChanging/.test(ua) && /platform\\/iOS/.test(ua);\n  }\n}\nexport function isAndroid() {\n  if (window && window.navigator && window.navigator.userAgent) {\n    var ua = window.navigator.userAgent;\n    return /Android;enjoyChanging_native/i.test(ua);\n  }\n}\nexport function isAliPay() {\n  if (window && window.navigator && window.navigator.userAgent) {\n    var ua = window.navigator.userAgent;\n    return /AlipayClient/.test(ua);\n  }\n}\nexport function isWechat() {\n  if (window && window.navigator && window.navigator.userAgent) {\n    var ua = window.navigator.userAgent;\n    return /MicroMessenger/.test(ua);\n  }\n}\nexport function isApp() {\n  return isIOS() || isAndroid();\n}\nexport function takePhoto() {\n  if (isAliPay()) {\n    return alipayTakePhoto();\n  }\n\n  if (isAndroid()) {\n    window.jsObj.takePhoto();\n    return new _Promise(function (resolve) {\n      window.chooseResult = function (stringkey, stringjson) {\n        if (stringkey === 'takePhoto') {\n          resolve('data:image/jpeg;base64,' + stringjson.path);\n        }\n      };\n    });\n  }\n\n  if (isIOS()) {\n    window.webkit.messageHandlers.takePhoto.postMessage('takePhoto');\n    return new _Promise(function (resolve) {\n      window.chooseResult = function (stringkey, stringjson) {\n        if (stringkey === 'takePhoto') {\n          var result = zipBase64('data:image/jpeg;base64,' + stringjson);\n          resolve(result);\n        }\n      };\n    });\n  }\n\n  return new _Promise(function (resolve) {\n    return resolve('');\n  });\n}\nexport function sendTitle(text) {\n  // tslint:disable-next-line\n  if (typeof window !== 'undefined') {\n    if (isIOS()) {\n      window.webkit && window.webkit.messageHandlers.sendTitle && window.webkit.messageHandlers.sendTitle.postMessage(text);\n    } else {\n      window.jsObj && window.jsObj.sendTitle && window.jsObj.sendTitle(text);\n    }\n  }\n} // function getAppVersion() {\n//   let val = /\\[NB\\](.*?)\\[\\!NB\\]/.exec(navigator.userAgent)\n//   if (val && val.length > 1) {\n//     val = JSON.parse(val[1])\n//     return +val.VERSION.replace(/\\./g, '')\n//   }\n//   return 0\n// }","map":{"version":3,"sources":["/Users/viser/mobile-next/src/utils/app.ts"],"names":["takePhoto","alipayTakePhoto","zipBase64","isIOS","window","navigator","userAgent","ua","test","isAndroid","isAliPay","isWechat","isApp","jsObj","resolve","chooseResult","stringkey","stringjson","path","webkit","messageHandlers","postMessage","result","sendTitle","text"],"mappings":"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","sourcesContent":["import { takePhoto as alipayTakePhoto } from './alipayJSBridge'\nimport { zipBase64 } from './tools'\nexport function isIOS() {\n  if (window && window.navigator && window.navigator.userAgent) {\n    const ua = window.navigator.userAgent\n    return /enjoyChanging/.test(ua) && /platform\\/iOS/.test(ua)\n  }\n}\n\nexport function isAndroid() {\n  if (window && window.navigator && window.navigator.userAgent) {\n    const ua = window.navigator.userAgent\n    return /Android;enjoyChanging_native/i.test(ua)\n  }\n}\n\nexport function isAliPay() {\n  if (window && window.navigator && window.navigator.userAgent) {\n    const ua = window.navigator.userAgent\n    return /AlipayClient/.test(ua)\n  }\n}\nexport function isWechat() {\n  if (window && window.navigator && window.navigator.userAgent) {\n    const ua = window.navigator.userAgent\n    return /MicroMessenger/.test(ua)\n  }\n}\nexport function isApp() {\n  return isIOS() || isAndroid()\n}\n\nexport function takePhoto(): Promise<string> {\n  if (isAliPay()) {\n    return alipayTakePhoto()\n  }\n  if (isAndroid()) {\n    window.jsObj.takePhoto()\n    return new Promise<string>(resolve => {\n      window.chooseResult = (stringkey: any, stringjson: any) => {\n        if (stringkey === 'takePhoto') {\n          resolve('data:image/jpeg;base64,' + stringjson.path)\n        }\n      }\n    })\n  }\n  if (isIOS()) {\n    window.webkit.messageHandlers.takePhoto.postMessage('takePhoto')\n    return new Promise<string>(resolve => {\n      window.chooseResult = (stringkey: string, stringjson: string) => {\n        if (stringkey === 'takePhoto') {\n          const result = zipBase64('data:image/jpeg;base64,' + stringjson)\n          resolve(result)\n        }\n      }\n    })\n  }\n  return new Promise(resolve => resolve(''))\n}\n\nexport function sendTitle(text: string) {\n  // tslint:disable-next-line\n  if (typeof window !== 'undefined') {\n    if (isIOS()) {\n      window.webkit &&\n        window.webkit.messageHandlers.sendTitle &&\n        window.webkit.messageHandlers.sendTitle.postMessage(text)\n    } else {\n      window.jsObj && window.jsObj.sendTitle && window.jsObj.sendTitle(text)\n    }\n  }\n}\n\n// function getAppVersion() {\n//   let val = /\\[NB\\](.*?)\\[\\!NB\\]/.exec(navigator.userAgent)\n//   if (val && val.length > 1) {\n//     val = JSON.parse(val[1])\n//     return +val.VERSION.replace(/\\./g, '')\n//   }\n//   return 0\n// }\n"]},"metadata":{},"sourceType":"module"}