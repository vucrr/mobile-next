{"ast":null,"code":"import wx from 'weixin-js-sdk';\nimport { axios } from 'utils/index';\n\nfunction getWechatSigniture() {\n  var shareUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : window.location.href;\n  axios.post('/node-api/common/jsapi/checkToken', {\n    url: shareUrl.split('#')[0]\n  }).then(function (_ref) {\n    var data = _ref.data;\n    wx.config({\n      debug: false,\n      // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。//debug最后要改为true\n      appId: data.app_id,\n      // 必填，公众号的唯一标识\n      timestamp: data.timestamp,\n      // 必填，生成签名的时间戳\n      nonceStr: data.nonce_str,\n      // 必填，生成签名的随机串\n      signature: data.signature,\n      // 必填，签名，见附录1\n      jsApiList: ['updateTimelineShareData', 'updateAppMessageShareData', 'onMenuShareTimeline', 'onMenuShareAppMessage', 'onMenuShareWeibo', 'hideMenuItems', 'showMenuItems', 'hideAllNonBaseMenuItem', 'showAllNonBaseMenuItem', 'chooseImage', 'previewImage', 'uploadImage', 'downloadImage', 'getNetworkType', 'openLocation', 'getLocation', 'hideOptionMenu', 'showOptionMenu', 'closeWindow', 'scanQRCode', 'chooseWXPay', 'openProductSpecificView', 'addCard', 'chooseCard', 'openCard'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2\n\n    });\n  });\n}\n\nfunction share(params) {\n  console.log(params);\n  var title = params.title,\n      link = params.link,\n      desc = params.desc,\n      imgUrl = params.imgUrl;\n  if (!link) link = window.location.href; // 获取签名信息\n\n  getWechatSigniture();\n  wx.ready(function () {\n    // “分享到朋友圈”及“分享到QQ空间”\n    wx.updateTimelineShareData({\n      title: title,\n      // 分享标题\n      link: link,\n      // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\n      imgUrl: imgUrl,\n      // 分享图标\n      success: function success() {// 设置成功\n      }\n    }); // “分享给朋友”及“分享到QQ”\n\n    wx.updateAppMessageShareData({\n      title: title,\n      // 分享标题\n      desc: desc,\n      // 分享描述\n      link: link,\n      // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\n      imgUrl: imgUrl,\n      // 分享图标\n      success: function success() {// 设置成功\n      }\n    }); // 分享到腾讯微博\n\n    wx.onMenuShareWeibo({\n      title: title,\n      // 分享标题\n      desc: desc,\n      // 分享描述\n      link: link,\n      // 分享链接\n      imgUrl: imgUrl,\n      // 分享图标\n      success: function success() {},\n      cancel: function cancel() {}\n    }); // 分享到朋友圈（即将废弃）\n\n    wx.onMenuShareTimeline({\n      title: title,\n      // 分享标题\n      link: link,\n      // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\n      imgUrl: imgUrl,\n      // 分享图标\n      success: function success() {}\n    }); // “分享给朋友”（即将废弃）\n\n    wx.onMenuShareAppMessage({\n      title: title,\n      // 分享标题\n      desc: desc,\n      // 分享描述\n      link: link,\n      // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\n      imgUrl: imgUrl,\n      // 分享图标\n      type: '',\n      // 分享类型,music、video或link，不填默认为link\n      dataUrl: '',\n      // 如果type是music或video，则要提供数据链接，默认为空\n      success: function success() {}\n    });\n  });\n}\n\nexport { share, wx };","map":{"version":3,"sources":["/Users/viser/mobile-next/src/utils/wechat.js"],"names":["wx","axios","getWechatSigniture","shareUrl","window","location","href","post","url","split","then","data","config","debug","appId","app_id","timestamp","nonceStr","nonce_str","signature","jsApiList","share","params","console","log","title","link","desc","imgUrl","ready","updateTimelineShareData","success","updateAppMessageShareData","onMenuShareWeibo","cancel","onMenuShareTimeline","onMenuShareAppMessage","type","dataUrl"],"mappings":"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","sourcesContent":["import wx from 'weixin-js-sdk'\nimport { axios } from 'utils/index'\n\nfunction getWechatSigniture(shareUrl = window.location.href) {\n  axios.post('/node-api/common/jsapi/checkToken', { url: shareUrl.split('#')[0] }).then(({ data }) => {\n    wx.config({\n      debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。//debug最后要改为true\n      appId: data.app_id, // 必填，公众号的唯一标识\n      timestamp: data.timestamp, // 必填，生成签名的时间戳\n      nonceStr: data.nonce_str, // 必填，生成签名的随机串\n      signature: data.signature, // 必填，签名，见附录1\n      jsApiList: [\n        'updateTimelineShareData',\n        'updateAppMessageShareData',\n        'onMenuShareTimeline',\n        'onMenuShareAppMessage',\n        'onMenuShareWeibo',\n        'hideMenuItems',\n        'showMenuItems',\n        'hideAllNonBaseMenuItem',\n        'showAllNonBaseMenuItem',\n        'chooseImage',\n        'previewImage',\n        'uploadImage',\n        'downloadImage',\n        'getNetworkType',\n        'openLocation',\n        'getLocation',\n        'hideOptionMenu',\n        'showOptionMenu',\n        'closeWindow',\n        'scanQRCode',\n        'chooseWXPay',\n        'openProductSpecificView',\n        'addCard',\n        'chooseCard',\n        'openCard',\n      ], // 必填，需要使用的JS接口列表，所有JS接口列表见附录2\n    })\n  })\n}\n\nfunction share(params) {\n  console.log(params)\n  let { title, link, desc, imgUrl } = params\n  if (!link) link = window.location.href\n  // 获取签名信息\n  getWechatSigniture()\n\n  wx.ready(() => {\n    // “分享到朋友圈”及“分享到QQ空间”\n    wx.updateTimelineShareData({\n      title, // 分享标题\n      link, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\n      imgUrl, // 分享图标\n      success() {\n        // 设置成功\n      },\n    })\n\n    // “分享给朋友”及“分享到QQ”\n    wx.updateAppMessageShareData({\n      title, // 分享标题\n      desc, // 分享描述\n      link, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\n      imgUrl, // 分享图标\n      success() {\n        // 设置成功\n      },\n    })\n\n    // 分享到腾讯微博\n    wx.onMenuShareWeibo({\n      title, // 分享标题\n      desc, // 分享描述\n      link, // 分享链接\n      imgUrl, // 分享图标\n      success() {},\n      cancel() {},\n    })\n\n    // 分享到朋友圈（即将废弃）\n    wx.onMenuShareTimeline({\n      title, // 分享标题\n      link, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\n      imgUrl, // 分享图标\n      success() {},\n    })\n\n    // “分享给朋友”（即将废弃）\n    wx.onMenuShareAppMessage({\n      title, // 分享标题\n      desc, // 分享描述\n      link, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\n      imgUrl, // 分享图标\n      type: '', // 分享类型,music、video或link，不填默认为link\n      dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空\n      success() {},\n    })\n  })\n}\n\nexport { share, wx }\n"]},"metadata":{},"sourceType":"module"}