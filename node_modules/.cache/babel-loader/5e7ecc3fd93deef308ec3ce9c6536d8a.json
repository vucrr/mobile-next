{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport classnames from 'classnames';\nimport { Icon, Link } from 'components';\nimport { withRouter } from 'next/router';\nimport React from 'react';\nimport { compose } from 'redux';\nimport { scrollToAnchor } from 'utils/tools';\nimport withSource from \"../withSource\";\nimport styles from \"./BackTop.less\";\nvar initialState = {\n  show: false\n};\n\nvar BackTop =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(BackTop, _React$Component);\n\n  function BackTop() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, BackTop);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(BackTop)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", initialState);\n\n    _defineProperty(_assertThisInitialized(_this), \"hideTabBar\", function () {\n      var _this$props = _this.props,\n          showTabBar = _this$props.showTabBar,\n          onHiddenTabBar = _this$props.onHiddenTabBar;\n      var route = _this.props.router.route;\n      var routesNeedHideTabBar = ['/product/detail'];\n\n      if (routesNeedHideTabBar.includes(route) && showTabBar && onHiddenTabBar) {\n        onHiddenTabBar();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleScroll\", function () {\n      var scrollTop = document.documentElement.scrollTop || document.body.scrollTop; // const scrollTop = (document.documentElement || document.body.parentNode || document.body).scrollTop\n\n      var show = _this.state.show;\n      var backTop = _this.props.backTop;\n\n      if (typeof backTop === 'boolean') {\n        backTop = 220;\n      }\n\n      if (scrollTop < backTop && show) {\n        _this.props.onToggle(false);\n\n        _this.setState({\n          show: false\n        });\n\n        _this.hideTabBar();\n      } else if (scrollTop > backTop && !show) {\n        _this.props.onToggle(true);\n\n        _this.setState({\n          show: true\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleBackTop\", function () {\n      scrollToAnchor('body');\n    });\n\n    return _this;\n  }\n\n  _createClass(BackTop, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      window.addEventListener('scroll', this.handleScroll);\n      this.handleScroll();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('scroll', this.handleScroll);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var show = this.state.show;\n      var _this$props2 = this.props,\n          ua = _this$props2.ua,\n          utm = _this$props2.utm; // ahs特殊处理\n\n      var query = this.props.router.query;\n      var isAhsForBaidu = query.utm_source === 'm_ahs' && query.utm_medium === 'm_ahs_homepage_footer_nav' && query.utm_campaign === 'm_xhj';\n      var initShow = !ua.get('isApp') && !ua.get('isAlipay') && !utm.get('isAnlaiye') && !utm.get('isWacai') && !utm.get('isCmblife') && !utm.get('isSamsungzs');\n      var utmMedium = ua.get('isAhsApp') && 'ahs' || ua.get('isNuomiApp') && 'nuomi' || 'm';\n\n      if (!initShow || isAhsForBaidu) {\n        return false;\n      }\n\n      return React.createElement(\"div\", {\n        className: classnames(styles.backtop_box, show && styles.show)\n      }, React.createElement(Link, {\n        className: styles.icon_box,\n        to: \"/site/appdownload?utm_source=xhj&utm_medium=\".concat(utmMedium, \"-roll&utm_campaign=download\")\n      }, \"APP\"), React.createElement(\"div\", {\n        className: styles.icon_box,\n        onClick: this.handleBackTop\n      }, React.createElement(Icon, {\n        className: styles.icon,\n        type: require('svg/arrow-left.svg')\n      })));\n    }\n  }]);\n\n  return BackTop;\n}(React.Component);\n\nexport default compose(withSource, withRouter)(BackTop);","map":{"version":3,"sources":["/Users/viser/mobile-next/src/components/BackTop/BackTop.tsx"],"names":["classnames","Icon","Link","withRouter","React","compose","scrollToAnchor","withSource","styles","initialState","show","BackTop","props","showTabBar","onHiddenTabBar","route","router","routesNeedHideTabBar","includes","scrollTop","document","documentElement","body","state","backTop","onToggle","setState","hideTabBar","window","addEventListener","handleScroll","removeEventListener","ua","utm","query","isAhsForBaidu","utm_source","utm_medium","utm_campaign","initShow","get","utmMedium","backtop_box","icon_box","handleBackTop","icon","require","Component"],"mappings":"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","sourcesContent":["import classnames from 'classnames'\nimport { Icon, Link } from 'components'\nimport { WithRouterProps, withRouter } from 'next/router'\nimport React from 'react'\nimport { compose } from 'redux'\nimport { scrollToAnchor } from 'utils/tools'\nimport withSource, { SourceProps } from '../withSource'\nimport styles from './BackTop.less'\n\ninterface BackTopProps extends Partial<WithRouterProps> {\n  backTop: any\n\n  onToggle(isShow: boolean): void\n\n  onHiddenTabBar?: Function\n  showTabBar?: boolean\n}\n\nconst initialState = {\n  show: false,\n}\n\ntype BackTopState = Readonly<typeof initialState>\n\nclass BackTop extends React.Component<BackTopProps & SourceProps, BackTopState> {\n  readonly state: BackTopState = initialState\n\n  componentDidMount() {\n    window.addEventListener('scroll', this.handleScroll)\n    this.handleScroll()\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('scroll', this.handleScroll)\n  }\n\n  hideTabBar = () => {\n    const { showTabBar, onHiddenTabBar } = this.props\n    const route = this.props.router!.route\n    const routesNeedHideTabBar = ['/product/detail']\n    if (routesNeedHideTabBar.includes(route) && showTabBar && onHiddenTabBar) {\n      onHiddenTabBar()\n    }\n  }\n\n  handleScroll = () => {\n    const scrollTop = document.documentElement.scrollTop || document.body.scrollTop\n    // const scrollTop = (document.documentElement || document.body.parentNode || document.body).scrollTop\n    const show = this.state.show\n    let { backTop } = this.props\n    if (typeof backTop === 'boolean') {\n      backTop = 220\n    }\n    if (scrollTop < backTop && show) {\n      this.props.onToggle(false)\n      this.setState({ show: false })\n      this.hideTabBar()\n    } else if (scrollTop > backTop && !show) {\n      this.props.onToggle(true)\n      this.setState({ show: true })\n    }\n  }\n\n  handleBackTop = () => {\n    scrollToAnchor('body')\n  }\n\n  render() {\n    const { show } = this.state\n    const { ua, utm } = this.props\n\n    // ahs特殊处理\n    const query = this.props.router!.query\n    const isAhsForBaidu =\n      query!.utm_source === 'm_ahs' &&\n      query!.utm_medium === 'm_ahs_homepage_footer_nav' &&\n      query!.utm_campaign === 'm_xhj'\n\n    const initShow =\n      !ua.get('isApp') &&\n      !ua.get('isAlipay') &&\n      !utm.get('isAnlaiye') &&\n      !utm.get('isWacai') &&\n      !utm.get('isCmblife') &&\n      !utm.get('isSamsungzs')\n    const utmMedium = (ua.get('isAhsApp') && 'ahs') || (ua.get('isNuomiApp') && 'nuomi') || 'm'\n\n    if (!initShow || isAhsForBaidu) {\n      return false\n    }\n\n    return (\n      <div className={classnames(styles.backtop_box, show && styles.show)}>\n        <Link\n          className={styles.icon_box}\n          to={`/site/appdownload?utm_source=xhj&utm_medium=${utmMedium}-roll&utm_campaign=download`}\n        >\n          APP\n        </Link>\n        <div className={styles.icon_box} onClick={this.handleBackTop}>\n          <Icon className={styles.icon} type={require('svg/arrow-left.svg')} />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default compose(\n  withSource,\n  withRouter,\n)(BackTop) as React.ComponentClass<BackTopProps>\n"]},"metadata":{},"sourceType":"module"}