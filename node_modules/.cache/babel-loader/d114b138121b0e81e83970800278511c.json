{"ast":null,"code":"import _Toast from \"antd-mobile/lib/toast\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React from 'react';\nimport Copy from \"../Copy\";\nimport withSource from \"../withSource\";\n\nvar Share =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Share, _React$Component);\n\n  function Share() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Share);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Share)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"shareInfoApp\", {\n      url: _this.props.url,\n      title: _this.props.title || '享换机',\n      content: _this.props.content || '666',\n      img: _this.props.img\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isWechat\", _this.props.ua.get('isWechat'));\n\n    _defineProperty(_assertThisInitialized(_this), \"isAlipay\", _this.props.ua.get('isAlipay'));\n\n    _defineProperty(_assertThisInitialized(_this), \"isApp\", _this.props.ua.get('isApp'));\n\n    _defineProperty(_assertThisInitialized(_this), \"isAndroidApp\", _this.props.ua.get('isAndroidApp'));\n\n    _defineProperty(_assertThisInitialized(_this), \"isIOSApp\", _this.props.ua.get('isIOSApp'));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleAppShare\", function () {\n      var stringObj = _JSON$stringify(_this.shareInfoApp);\n\n      if (_this.isAndroidApp) {\n        // 调用安卓App分享\n        window.jsObj.startShare(stringObj);\n      } else {\n        // 调用iosApp分享\n        window.webkit.messageHandlers.startShare.postMessage(stringObj);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleWechatShare\", function () {\n      var _require = require(\"../../utils/wechat\"),\n          share = _require.share;\n\n      share({\n        title: _this.shareInfoApp.title,\n        desc: _this.shareInfoApp.content,\n        imgUrl: _this.shareInfoApp.img,\n        link: _this.shareInfoApp.url\n      });\n\n      _Toast.info('点击右上角分享给好友', 1.5);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleAlipayShare\", function () {\n      var _require2 = require(\"../../utils/alipayShare\"),\n          alipayShare = _require2.alipayShare;\n\n      alipayShare({\n        title: _this.shareInfoApp.title,\n        content: _this.shareInfoApp.content,\n        image: _this.shareInfoApp.img,\n        url: _this.props.url\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickCopy\", function () {\n      _Toast.info('复制成功，请去粘贴分享', 1.5);\n    });\n\n    return _this;\n  }\n\n  _createClass(Share, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (!this.props.beforehand) {\n        if (this.isWechat) {\n          var _require3 = require(\"../../utils/wechat\"),\n              share = _require3.share;\n\n          share({\n            title: this.shareInfoApp.title,\n            desc: this.shareInfoApp.content,\n            imgUrl: this.shareInfoApp.img,\n            link: this.shareInfoApp.url\n          });\n        }\n\n        if (this.isAlipay) {\n          var _require4 = require(\"../../utils/alipayShare\"),\n              initShare = _require4.initShare;\n\n          initShare({\n            title: this.shareInfoApp.title,\n            content: this.shareInfoApp.content,\n            image: this.shareInfoApp.img,\n            url: this.shareInfoApp.url\n          });\n        }\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var children = this.props.children;\n      return React.createElement(React.Fragment, null, this.isApp && React.createElement(\"div\", {\n        onClick: this.handleAppShare\n      }, children), this.isWechat && React.createElement(\"div\", {\n        onClick: this.handleWechatShare\n      }, children), this.isAlipay && React.createElement(\"div\", {\n        onClick: this.handleAlipayShare\n      }, children), !this.isApp && !this.isWechat && !this.isAlipay && React.createElement(Copy, {\n        text: this.shareInfoApp.url,\n        onCopied: this.onClickCopy\n      }, children));\n    }\n  }]);\n\n  return Share;\n}(React.Component);\n\nexport default withSource(Share);","map":{"version":3,"sources":["/Users/viser/mobile-next/src/components/Share/Share.tsx"],"names":["React","Copy","withSource","Share","url","props","title","content","img","ua","get","stringObj","shareInfoApp","isAndroidApp","window","jsObj","startShare","webkit","messageHandlers","postMessage","require","share","desc","imgUrl","link","info","alipayShare","image","beforehand","isWechat","isAlipay","initShare","children","isApp","handleAppShare","handleWechatShare","handleAlipayShare","onClickCopy","Component"],"mappings":"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","sourcesContent":["import { Toast } from 'antd-mobile'\nimport React from 'react'\nimport Copy from '../Copy'\nimport withSource, { SourceProps } from '../withSource'\n\ninterface Props {\n  url: string\n  title?: string\n  content?: string\n  img: string\n  children: any\n  beforehand?: boolean\n}\n\ninterface State {}\n\nclass Share extends React.Component<Props & SourceProps, State> {\n  shareInfoApp = {\n    url: this.props.url,\n    title: this.props.title || '享换机',\n    content: this.props.content || '666',\n    img: this.props.img,\n  }\n  isWechat = this.props.ua.get('isWechat')\n  isAlipay = this.props.ua.get('isAlipay')\n  isApp = this.props.ua.get('isApp')\n  isAndroidApp = this.props.ua.get('isAndroidApp')\n  isIOSApp = this.props.ua.get('isIOSApp')\n\n  componentDidMount() {\n    if (!this.props.beforehand) {\n      if (this.isWechat) {\n        const { share } = require('utils/wechat')\n        share({\n          title: this.shareInfoApp.title,\n          desc: this.shareInfoApp.content,\n          imgUrl: this.shareInfoApp.img,\n          link: this.shareInfoApp.url,\n        })\n      }\n      if (this.isAlipay) {\n        const { initShare } = require('utils/alipayShare')\n        initShare({\n          title: this.shareInfoApp.title,\n          content: this.shareInfoApp.content,\n          image: this.shareInfoApp.img,\n          url: this.shareInfoApp.url,\n        })\n      }\n    }\n  }\n\n  handleAppShare = () => {\n    const stringObj = JSON.stringify(this.shareInfoApp)\n    if (this.isAndroidApp) {\n      // 调用安卓App分享\n      window.jsObj.startShare(stringObj)\n    } else {\n      // 调用iosApp分享\n      window.webkit.messageHandlers.startShare.postMessage(stringObj)\n    }\n  }\n\n  handleWechatShare = () => {\n    const { share } = require('utils/wechat')\n    share({\n      title: this.shareInfoApp.title,\n      desc: this.shareInfoApp.content,\n      imgUrl: this.shareInfoApp.img,\n      link: this.shareInfoApp.url,\n    })\n    Toast.info('点击右上角分享给好友', 1.5)\n  }\n\n  handleAlipayShare = () => {\n    const { alipayShare } = require('utils/alipayShare')\n    alipayShare({\n      title: this.shareInfoApp.title,\n      content: this.shareInfoApp.content,\n      image: this.shareInfoApp.img,\n      url: this.props.url,\n    })\n  }\n\n  onClickCopy = () => {\n    Toast.info('复制成功，请去粘贴分享', 1.5)\n  }\n\n  render() {\n    const { children } = this.props\n    return (\n      <>\n        {this.isApp && <div onClick={this.handleAppShare}>{children}</div>}\n        {this.isWechat && <div onClick={this.handleWechatShare}>{children}</div>}\n        {this.isAlipay && <div onClick={this.handleAlipayShare}>{children}</div>}\n        {!this.isApp &&\n          !this.isWechat &&\n          !this.isAlipay && (\n            <Copy text={this.shareInfoApp.url} onCopied={this.onClickCopy}>\n              {children}\n            </Copy>\n          )}\n      </>\n    )\n  }\n}\n\nexport default withSource<Props>(Share)\n"]},"metadata":{},"sourceType":"module"}