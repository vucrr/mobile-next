{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _Toast from \"antd-mobile/lib/toast\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _Flex from \"antd-mobile/lib/flex\";\nimport { SendEmergencyContact, finishCreditEntrydata, sendGPSFlow } from 'actions/myTrade/assess/list';\nimport { Button, Icon, Link, Switch } from 'components';\nimport { TrackEventTradeDev } from 'configs/trackEventLabels';\nimport React, { useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport Lottie from 'react-lottie';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { getContacts, getLocation } from 'utils/app';\nimport { trackClickEvent } from 'utils/piwik';\nimport { delayHandle } from 'utils/tools';\nimport styles from \"./InfoList.less\";\nvar Item = _Flex.Item;\nvar StepCode;\n\n(function (StepCode) {\n  StepCode[\"ZhimaCredit\"] = \"zhima_credit\";\n  StepCode[\"GpsLocation\"] = \"gps_location\";\n  StepCode[\"EmergencyContact\"] = \"emergency_contact\";\n})(StepCode || (StepCode = {}));\n\nfunction ShowTipsModel() {\n  var div = document.createElement('div');\n  document.body.appendChild(div);\n\n  function close() {\n    ReactDOM.unmountComponentAtNode(div);\n\n    if (div && div.parentNode) {\n      div.parentNode.removeChild(div);\n    }\n  }\n\n  var defaultOptions = {\n    loop: true,\n    autoplay: true,\n    animationData: require('lottie/verifying.json')\n  };\n  ReactDOM.render(React.createElement(\"div\", {\n    className: styles.TipsModel\n  }, React.createElement(\"div\", {\n    className: styles.modelBg\n  }, React.createElement(Lottie, {\n    options: defaultOptions,\n    width: 36,\n    height: 36\n  }), React.createElement(\"p\", null, \"\\u8D44\\u6599\\u8BA4\\u8BC1\\u4E2D\\uFF0C\\u8BF7\\u8010\\u5FC3\\u7B49\\u5F85\"))), div);\n  return {\n    close: close\n  };\n}\n\nvar InfoList = function InfoList(_ref) {\n  var query = _ref.query,\n      stepList = _ref.stepList,\n      creditTips = _ref.creditTips,\n      submitText = _ref.submitText,\n      submitStatus = _ref.submitStatus,\n      agreementInfo = _ref.agreementInfo,\n      onSendGPSFlow = _ref.onSendGPSFlow,\n      onFinishCreditEntrydata = _ref.onFinishCreditEntrydata,\n      onSendEmergencyContact = _ref.onSendEmergencyContact;\n  var showModalInstance = null;\n\n  var _useState = useState(true),\n      _useState2 = _slicedToArray(_useState, 2),\n      isAgree = _useState2[0],\n      setIsAgree = _useState2[1];\n\n  var checkZhimaIsDone = function checkZhimaIsDone() {\n    var zhimaIsDone = stepList.find(function (item) {\n      return item.get('step_code') === StepCode.ZhimaCredit && item.get('step_status') === 1;\n    });\n\n    if (!zhimaIsDone) {\n      _Toast.info('请先去授权芝麻信用');\n    }\n\n    return zhimaIsDone;\n  };\n\n  var handleLink =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(item) {\n      var result, _result;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(item.get('step_status') === 1)) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 2:\n              if (!(item.get('step_code') === StepCode.GpsLocation)) {\n                _context.next = 12;\n                break;\n              }\n\n              if (!checkZhimaIsDone()) {\n                _context.next = 10;\n                break;\n              }\n\n              trackClickEvent({\n                category: TrackEventTradeDev.CreditEvaluation.Name,\n                label: TrackEventTradeDev.CreditEvaluation.GetLocation\n              });\n              _context.next = 7;\n              return getLocation();\n\n            case 7:\n              result = _context.sent;\n\n              _Toast.info(_JSON$stringify(result));\n\n              typeof result === 'object' && onSendGPSFlow(result);\n\n            case 10:\n              _context.next = 24;\n              break;\n\n            case 12:\n              if (!(item.get('step_code') === StepCode.EmergencyContact)) {\n                _context.next = 22;\n                break;\n              }\n\n              if (!checkZhimaIsDone()) {\n                _context.next = 20;\n                break;\n              }\n\n              trackClickEvent({\n                category: TrackEventTradeDev.CreditEvaluation.Name,\n                label: TrackEventTradeDev.CreditEvaluation.AddEmergencyContact\n              });\n              _context.next = 17;\n              return getContacts();\n\n            case 17:\n              _result = _context.sent;\n\n              if (typeof _result === 'string') {\n                onSendEmergencyContact(_result);\n                window.location.href = item.get('step_url');\n              }\n\n              _Toast.info(\"\".concat(_result));\n\n            case 20:\n              _context.next = 24;\n              break;\n\n            case 22:\n              trackClickEvent({\n                category: TrackEventTradeDev.CreditEvaluation.Name,\n                label: TrackEventTradeDev.CreditEvaluation.AuthorizationZHIMA\n              });\n              window.location.href = item.get('step_url');\n\n            case 24:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleLink(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleSubmit =\n  /*#__PURE__*/\n  function () {\n    var _ref3 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (isAgree) {\n                _context2.next = 4;\n                break;\n              }\n\n              _Toast.info(\"\\u8BF7\\u540C\\u610F\".concat(agreementInfo.agreementName));\n\n              _context2.next = 11;\n              break;\n\n            case 4:\n              showModalInstance = ShowTipsModel();\n              trackClickEvent({\n                category: TrackEventTradeDev.CreditEvaluation.Name,\n                label: TrackEventTradeDev.CreditEvaluation.ToEvaluate\n              });\n              _context2.next = 8;\n              return onFinishCreditEntrydata({\n                pis_code: query.pis_code || '',\n                trade_no: query.trade_no,\n                pay_no: query.pay_no,\n                type: query.type\n              });\n\n            case 8:\n              _context2.next = 10;\n              return delayHandle(0);\n\n            case 10:\n              showModalInstance.close();\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleSubmit() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(\"div\", {\n    className: styles.infoList\n  }, React.createElement(\"p\", {\n    className: styles.creditTips\n  }, creditTips), React.createElement(\"div\", {\n    className: styles.list\n  }, stepList.map(function (item, key) {\n    return React.createElement(_Flex, {\n      key: key,\n      className: styles.item,\n      onClick: function onClick() {\n        return handleLink(item);\n      }\n    }, React.createElement(Item, {\n      className: styles.left\n    }, React.createElement(\"img\", {\n      src: item.get('step_icon'),\n      alt: \"\"\n    }), item.get('step_title')), item.get('step_status') === 1 && React.createElement(Icon, {\n      size: \"xxs\",\n      color: \"#00AA99\",\n      type: require('svg/xuan.svg')\n    }), React.createElement(\"span\", {\n      className: item.get('step_status') === 0 ? styles.stepUnDid : styles.stepDid\n    }, item.get('step_info')), item.get('step_status') === 0 && React.createElement(Icon, {\n      size: \"xxs\",\n      color: \"#CCCCCC\",\n      type: require('svg/youjiantouxin.svg')\n    }));\n  })), React.createElement(_Flex, {\n    className: styles.agree\n  }, React.createElement(Switch, {\n    className: styles.agreeText,\n    checked: isAgree,\n    onChange: function onChange() {\n      return setIsAgree(!isAgree);\n    }\n  }, agreementInfo.agreementMsg), React.createElement(Link, {\n    native: true,\n    to: agreementInfo.agreementUrl,\n    className: styles.agreement_name\n  }, agreementInfo.agreementName)), React.createElement(Button, {\n    type: \"primary\",\n    disabled: submitStatus === 0,\n    className: styles.submitText,\n    onClick: handleSubmit\n  }, submitText));\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    onSendGPSFlow: bindActionCreators(sendGPSFlow, dispatch),\n    onFinishCreditEntrydata: bindActionCreators(finishCreditEntrydata, dispatch),\n    onSendEmergencyContact: bindActionCreators(SendEmergencyContact, dispatch)\n  };\n};\n\nexport default connect(null, mapDispatchToProps)(InfoList);","map":{"version":3,"sources":["/Users/viser/mobile-next/src/containers/MyTrade/Assess/List/InfoList.tsx"],"names":["SendEmergencyContact","finishCreditEntrydata","sendGPSFlow","Button","Icon","Link","Switch","TrackEventTradeDev","React","useState","ReactDOM","Lottie","connect","bindActionCreators","getContacts","getLocation","trackClickEvent","delayHandle","styles","Item","StepCode","ShowTipsModel","div","document","createElement","body","appendChild","close","unmountComponentAtNode","parentNode","removeChild","defaultOptions","loop","autoplay","animationData","require","render","TipsModel","modelBg","InfoList","query","stepList","creditTips","submitText","submitStatus","agreementInfo","onSendGPSFlow","onFinishCreditEntrydata","onSendEmergencyContact","showModalInstance","isAgree","setIsAgree","checkZhimaIsDone","zhimaIsDone","find","item","get","ZhimaCredit","info","handleLink","GpsLocation","category","CreditEvaluation","Name","label","GetLocation","result","EmergencyContact","AddEmergencyContact","window","location","href","AuthorizationZHIMA","handleSubmit","agreementName","ToEvaluate","pis_code","trade_no","pay_no","type","infoList","list","map","key","left","stepUnDid","stepDid","agree","agreeText","agreementMsg","agreementUrl","agreement_name","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import {\n  SendEmergencyContact,\n  SendGPSFlowParams,\n  finishCreditEntrydata,\n  sendGPSFlow,\n} from 'actions/myTrade/assess/list'\nimport { Flex, Toast } from 'antd-mobile'\nimport { Button, Icon, Link, Switch } from 'components'\nimport { TrackEventTradeDev } from 'configs/trackEventLabels'\nimport React, { useState } from 'react'\nimport ReactDOM from 'react-dom'\nimport Lottie from 'react-lottie'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport { getContacts, getLocation } from 'utils/app'\nimport { trackClickEvent } from 'utils/piwik'\nimport { delayHandle } from 'utils/tools'\nimport { Query } from '.'\nimport styles from './InfoList.less'\n\nconst Item = Flex.Item\n\nexport interface InfoListProps {\n  query: Query\n  creditTips: string\n  submitText: string\n  submitStatus: number\n  agreementInfo: any\n  stepList: any\n  onSendGPSFlow: (params: SendGPSFlowParams) => void\n  onFinishCreditEntrydata: (params: Query) => any\n  onFinishSupplementStep: (params: Query) => any\n  onSendEmergencyContact: (params: string) => void\n}\n\nenum StepCode {\n  ZhimaCredit = 'zhima_credit',\n  GpsLocation = 'gps_location',\n  EmergencyContact = 'emergency_contact',\n}\n\nfunction ShowTipsModel(): any {\n  const div: any = document.createElement('div')\n  document.body.appendChild(div)\n\n  function close() {\n    ReactDOM.unmountComponentAtNode(div)\n    if (div && div.parentNode) {\n      div.parentNode.removeChild(div)\n    }\n  }\n\n  const defaultOptions = {\n    loop: true,\n    autoplay: true,\n    animationData: require('lottie/verifying.json'),\n  }\n\n  ReactDOM.render(\n    <div className={styles.TipsModel}>\n      <div className={styles.modelBg}>\n        <Lottie options={defaultOptions} width={36} height={36} />\n        <p>资料认证中，请耐心等待</p>\n      </div>\n    </div>,\n    div,\n  )\n  return {\n    close,\n  }\n}\n\nconst InfoList: React.FunctionComponent<InfoListProps> = ({\n  query,\n  stepList,\n  creditTips,\n  submitText,\n  submitStatus,\n  agreementInfo,\n  onSendGPSFlow,\n  onFinishCreditEntrydata,\n  onSendEmergencyContact,\n}) => {\n  let showModalInstance: any = null\n  const [isAgree, setIsAgree] = useState(true)\n  const checkZhimaIsDone = () => {\n    const zhimaIsDone = stepList.find(\n      (item: any) => item.get('step_code') === StepCode.ZhimaCredit && item.get('step_status') === 1,\n    )\n    if (!zhimaIsDone) {\n      Toast.info('请先去授权芝麻信用')\n    }\n    return zhimaIsDone\n  }\n\n  const handleLink = async (item: any) => {\n    if (item.get('step_status') === 1) {\n      return\n    }\n    if (item.get('step_code') === StepCode.GpsLocation) {\n      if (checkZhimaIsDone()) {\n        trackClickEvent({\n          category: TrackEventTradeDev.CreditEvaluation.Name,\n          label: TrackEventTradeDev.CreditEvaluation.GetLocation,\n        })\n        const result = await getLocation()\n        Toast.info(JSON.stringify(result))\n        typeof result === 'object' && onSendGPSFlow(result)\n      }\n    } else if (item.get('step_code') === StepCode.EmergencyContact) {\n      if (checkZhimaIsDone()) {\n        trackClickEvent({\n          category: TrackEventTradeDev.CreditEvaluation.Name,\n          label: TrackEventTradeDev.CreditEvaluation.AddEmergencyContact,\n        })\n        const result = await getContacts()\n        if (typeof result === 'string') {\n          onSendEmergencyContact(result)\n          window.location.href = item.get('step_url')\n        }\n        Toast.info(`${result}`)\n      }\n    } else {\n      trackClickEvent({\n        category: TrackEventTradeDev.CreditEvaluation.Name,\n        label: TrackEventTradeDev.CreditEvaluation.AuthorizationZHIMA,\n      })\n      window.location.href = item.get('step_url')\n    }\n  }\n\n  const handleSubmit = async () => {\n    if (!isAgree) {\n      Toast.info(`请同意${agreementInfo.agreementName}`)\n    } else {\n      showModalInstance = ShowTipsModel()\n      trackClickEvent({\n        category: TrackEventTradeDev.CreditEvaluation.Name,\n        label: TrackEventTradeDev.CreditEvaluation.ToEvaluate,\n      })\n      await onFinishCreditEntrydata({\n        pis_code: query.pis_code || '',\n        trade_no: query.trade_no,\n        pay_no: query.pay_no,\n        type: query.type,\n      })\n      await delayHandle(0)\n      showModalInstance.close()\n    }\n  }\n\n  return (\n    <div className={styles.infoList}>\n      <p className={styles.creditTips}>{creditTips}</p>\n      <div className={styles.list}>\n        {stepList.map((item: any, key: any) => (\n          <Flex key={key} className={styles.item} onClick={() => handleLink(item)}>\n            <Item className={styles.left}>\n              <img src={item.get('step_icon')} alt=\"\" />\n              {item.get('step_title')}\n            </Item>\n            {item.get('step_status') === 1 && <Icon size=\"xxs\" color=\"#00AA99\" type={require('svg/xuan.svg')} />}\n            <span className={item.get('step_status') === 0 ? styles.stepUnDid : styles.stepDid}>\n              {item.get('step_info')}\n            </span>\n            {item.get('step_status') === 0 && (\n              <Icon size=\"xxs\" color=\"#CCCCCC\" type={require('svg/youjiantouxin.svg')} />\n            )}\n          </Flex>\n        ))}\n      </div>\n      <Flex className={styles.agree}>\n        <Switch className={styles.agreeText} checked={isAgree} onChange={() => setIsAgree(!isAgree)}>\n          {agreementInfo.agreementMsg}\n        </Switch>\n        <Link native={true} to={agreementInfo.agreementUrl} className={styles.agreement_name}>\n          {agreementInfo.agreementName}\n        </Link>\n      </Flex>\n      <Button type=\"primary\" disabled={submitStatus === 0} className={styles.submitText} onClick={handleSubmit}>\n        {submitText}\n      </Button>\n    </div>\n  )\n}\n\nconst mapDispatchToProps = (dispatch: any) => ({\n  onSendGPSFlow: bindActionCreators(sendGPSFlow, dispatch),\n  onFinishCreditEntrydata: bindActionCreators(finishCreditEntrydata, dispatch),\n  onSendEmergencyContact: bindActionCreators(SendEmergencyContact, dispatch),\n})\n\nexport default connect(\n  null,\n  mapDispatchToProps,\n)(InfoList)\n"]},"metadata":{},"sourceType":"module"}