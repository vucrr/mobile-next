{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport * as homeActions from 'actions/home';\nimport { Container, Header, TabBar } from 'components';\nimport Error from 'containers/Error';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport cookies from 'utils/cookies';\nimport { getDomain, noop } from 'utils/tools';\nimport ActivityList from \"./ActivityList\";\nimport AdvertModal from \"./AdvertModal\";\nimport BottomBox from \"./BottomBox\";\nimport Brands from \"./Brands\";\nimport Coupons from \"./Coupons\";\nimport HeaderSwiper from \"./HeaderSwiper\";\nimport HotActivity from \"./HotActivity\";\nimport RecommendSwiper from \"./RecommendSwiper\";\nimport TopDownLoad from \"./TopDownLoad\";\n\nvar Home =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Home, _React$Component);\n\n  function Home() {\n    _classCallCheck(this, Home);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Home).apply(this, arguments));\n  }\n\n  _createClass(Home, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var home = this.props.home;\n\n      if (home.get('userInfo')) {\n        var expires = new Date(new Date().setHours(24, 0, 0, 0));\n        var domain = getDomain(location.hostname);\n        var userToken = home.getIn(['userInfo', 'userToken']);\n        var userId = home.getIn(['userInfo', 'user_id_v2']);\n        cookies.set('userToken', userToken, {\n          expires: expires,\n          domain: domain\n        });\n        cookies.set('user_id_v2', userId, {\n          expires: expires,\n          domain: domain\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          error = _this$props.error,\n          query = _this$props.query,\n          home = _this$props.home,\n          onHomeActions = _this$props.onHomeActions;\n\n      if (error) {\n        return React.createElement(Error, {\n          statusCode: error.status,\n          errorMsg: error.errorMsg\n        });\n      }\n\n      var headerProps = {\n        icon: '',\n        hidden: true,\n        // backTop: true,\n        onLeftClick: noop,\n        rightContent: ''\n      };\n      var containerProps = {\n        renderHeader: React.createElement(Header, headerProps, this.props.brand),\n        renderTabBar: React.createElement(TabBar, {\n          selectedTab: \"home\"\n        }),\n        fixedTabBar: true,\n        bgColor: '#fff'\n      };\n      var popup = home.get('popup');\n      return React.createElement(Container, containerProps, React.createElement(TopDownLoad, {\n        query: query\n      }), React.createElement(HeaderSwiper, {\n        festival: home.get('festival'),\n        brand: home.getIn(['brand', 'model_data']),\n        list: home.getIn(['banner', 'model_data']),\n        brands: home.getIn(['brand_endorsement', 'model_data'])\n      }), React.createElement(Brands, {\n        list: home.getIn(['icons', 'model_data'])\n      }), React.createElement(Coupons, {\n        info: home.get('userTag'),\n        fetchList: onHomeActions.fetchUserTag\n      }), React.createElement(HotActivity, {\n        title: home.getIn(['three_palace', 'model_title']),\n        list: home.getIn(['three_palace', 'model_data'])\n      }), React.createElement(RecommendSwiper, {\n        title: home.getIn(['recommend', 'model_title']),\n        list: home.getIn(['recommend', 'model_data'])\n      }), React.createElement(ActivityList, {\n        title: home.getIn(['subject', 'model_title']),\n        list: home.getIn(['subject', 'model_data'])\n      }), React.createElement(BottomBox, {\n        title: home.getIn(['brand_story', 'model_title']),\n        list: home.getIn(['brand_story', 'model_data'])\n      }), !!popup && !!popup.get('id') && React.createElement(AdvertModal, {\n        popup: popup\n      }));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(_ref) {\n        var store, query, req, data;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                store = _ref.store, query = _ref.query, req = _ref.req;\n                _context.next = 3;\n                return store.dispatch(homeActions.fetchInfo({\n                  query: query,\n                  req: req\n                }));\n\n              case 3:\n                data = _context.sent;\n\n                if (!data.status) {\n                  _context.next = 6;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", {\n                  error: data\n                });\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return Home;\n}(React.Component);\n\n_defineProperty(Home, \"defaultProps\", {\n  brand: '享换机'\n});\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    home: state.get('home'),\n    brand: state.getIn(['serverApp', 'utm', 'brand'])\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    onHomeActions: bindActionCreators(homeActions, dispatch)\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Home);","map":{"version":3,"sources":["/Users/viser/mobile-next/src/containers/Home/index.tsx"],"names":["homeActions","Container","Header","TabBar","Error","React","connect","bindActionCreators","cookies","getDomain","noop","ActivityList","AdvertModal","BottomBox","Brands","Coupons","HeaderSwiper","HotActivity","RecommendSwiper","TopDownLoad","Home","home","props","get","expires","Date","setHours","domain","location","hostname","userToken","getIn","userId","set","error","query","onHomeActions","status","errorMsg","headerProps","icon","hidden","onLeftClick","rightContent","containerProps","renderHeader","brand","renderTabBar","fixedTabBar","bgColor","popup","fetchUserTag","store","req","dispatch","fetchInfo","data","Component","mapStateToProps","state","mapDispatchToProps"],"mappings":"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","sourcesContent":["import { GetInitialPropsContext } from '@@types/next'\nimport * as homeActions from 'actions/home'\nimport { Container, Header, TabBar } from 'components'\nimport Error from 'containers/Error'\nimport { ErrorObject } from 'interfaces/error'\nimport React from 'react'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport cookies from 'utils/cookies'\nimport { getDomain, noop } from 'utils/tools'\nimport ActivityList from './ActivityList'\nimport AdvertModal from './AdvertModal'\nimport BottomBox from './BottomBox'\nimport Brands from './Brands'\nimport Coupons from './Coupons'\nimport HeaderSwiper from './HeaderSwiper'\nimport HotActivity from './HotActivity'\nimport RecommendSwiper from './RecommendSwiper'\nimport TopDownLoad from './TopDownLoad'\n\ninterface HomeProps extends ErrorObject {\n  home: any\n  brand: string\n  hideOwnBrand: boolean\n  utm: any\n  query: any\n  onHomeActions: any\n}\n\nclass Home extends React.Component<HomeProps> {\n  static defaultProps = {\n    brand: '享换机',\n  }\n\n  static async getInitialProps({ store, query, req }: GetInitialPropsContext) {\n    const data = await store.dispatch(homeActions.fetchInfo({ query, req }))\n    if (data.status) {\n      return { error: data }\n    }\n  }\n\n  componentDidMount() {\n    const { home } = this.props\n    if (home.get('userInfo')) {\n      const expires = new Date(new Date().setHours(24, 0, 0, 0))\n      const domain = getDomain(location.hostname)\n      const userToken = home.getIn(['userInfo', 'userToken'])\n      const userId = home.getIn(['userInfo', 'user_id_v2'])\n\n      cookies.set('userToken', userToken, { expires, domain })\n      cookies.set('user_id_v2', userId, { expires, domain })\n    }\n  }\n\n  render() {\n    const { error, query, home, onHomeActions } = this.props\n\n    if (error) {\n      return <Error statusCode={error.status} errorMsg={error.errorMsg} />\n    }\n\n    const headerProps = {\n      icon: '',\n      hidden: true,\n      // backTop: true,\n      onLeftClick: noop,\n      rightContent: '',\n    }\n\n    const containerProps = {\n      renderHeader: <Header {...headerProps}>{this.props.brand}</Header>,\n      renderTabBar: <TabBar selectedTab=\"home\" />,\n      fixedTabBar: true,\n      bgColor: '#fff',\n    }\n\n    const popup = home.get('popup')\n\n    return (\n      <Container {...containerProps}>\n        <TopDownLoad query={query} />\n        <HeaderSwiper\n          festival={home.get('festival')}\n          brand={home.getIn(['brand', 'model_data'])}\n          list={home.getIn(['banner', 'model_data'])}\n          brands={home.getIn(['brand_endorsement', 'model_data'])}\n        />\n        <Brands list={home.getIn(['icons', 'model_data'])} />\n        <Coupons info={home.get('userTag')} fetchList={onHomeActions.fetchUserTag} />\n        <HotActivity\n          title={home.getIn(['three_palace', 'model_title'])}\n          list={home.getIn(['three_palace', 'model_data'])}\n        />\n        <RecommendSwiper\n          title={home.getIn(['recommend', 'model_title'])}\n          list={home.getIn(['recommend', 'model_data'])}\n        />\n        <ActivityList title={home.getIn(['subject', 'model_title'])} list={home.getIn(['subject', 'model_data'])} />\n        <BottomBox\n          title={home.getIn(['brand_story', 'model_title'])}\n          list={home.getIn(['brand_story', 'model_data'])}\n        />\n        {!!popup && !!popup.get('id') && <AdvertModal popup={popup} />}\n      </Container>\n    )\n  }\n}\n\nconst mapStateToProps = (state: any) => ({\n  home: state.get('home'),\n  brand: state.getIn(['serverApp', 'utm', 'brand']),\n})\n\nconst mapDispatchToProps = (dispatch: any) => ({\n  onHomeActions: bindActionCreators(homeActions, dispatch),\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(Home)\n"]},"metadata":{},"sourceType":"module"}